# Задан DataFrame countries_df, содержащий следующие столбцы: название страны, население (population) в миллионах человек и площадь страны (square) в квадратных километрах.
# countries_df = pd.DataFrame({
#     'country': ['Англия', 'Канада', 'США', 'Россия', 'Украина', 'Беларусь', 'Казахстан'],
#     'population': [56.29, 38.05, 322.28, 146.24, 45.5, 9.5, 17.04],
#     'square': [133396, 9984670, 9826630, 17125191, 603628, 207600, 2724902]
# })
# Для каждой страны рассчитайте плотность населения (количество человек на квадратный километр).
# Затем по полученным данным рассчитайте среднее по плотностям населения в указанных странах. Ответ округлите до сотых.
# Плотность населения рассчитывается как количество человек, проживающих на территории отдельной страны, делённое на площадь этой страны. Обратите внимание, что население в таблице представлено в миллионах.

import pandas as pd

def delete_columns(df, col=[]):
    """
    Удаляет указанные столбцы из DataFrame и возвращает новую таблицу.
    Если одного из столбцов не существует, возвращает None.

    :param df: DataFrame
    :param col: Список названий столбцов для удаления
    :return: Новый DataFrame без указанных столбцов или None
    """
    # Проверяем, существуют ли все указанные столбцы в DataFrame
    if not set(col).issubset(df.columns):
        return None

    # Удаляем указанные столбцы и возвращаем новую таблицу
    return df.drop(columns=col)

# Пример использования
customer_df = pd.DataFrame({
    'number': [0, 1, 2, 3, 4],
    'cust_id': [128, 1201, 9832, 4392, 7472],
    'cust_age': [13, 21, 19, 21, 60],
    'cust_sale': [0, 0, 0.2, 0.15, 0.3],
    'cust_year_birth': [2008, 2000, 2002, 2000, 1961],
    'cust_order': [1400, 14142, 900, 1240, 8430]
})

# Успешное удаление существующих столбцов
result_1 = delete_columns(customer_df, ['cust_id', 'cust_age'])
print(result_1)

# Попытка удалить несуществующий столбец
result_2 = delete_columns(customer_df, ['cust_id', 'nonexistent_column'])
print(result_2)

# Рассчёт плотности населения и средней плотности
countries_df = pd.DataFrame({
    'country': ['Англия', 'Канада', 'США', 'Россия', 'Украина', 'Беларусь', 'Казахстан'],
    'population': [56.29, 38.05, 322.28, 146.24, 45.5, 9.5, 17.04],
    'square': [133396, 9984670, 9826630, 17125191, 603628, 207600, 2724902]
})

# Добавление столбца с плотностью населения
countries_df['density'] = (countries_df['population'] * 1_000_000) / countries_df['square']

# Вычисление средней плотности населения
average_density = countries_df['density'].mean()

# Округление до сотых
average_density_rounded = round(average_density, 2)

print(f"Средняя плотность населения: {average_density_rounded}")